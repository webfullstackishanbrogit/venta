<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta charset="utf-8" />

	<meta name="description" content="" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<meta name="author" content="">

	<!-- bootstrap & fontawesome -->
	<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
	<link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />
	<!-- page specific plugin styles -->
	<!-- page specific plugin styles -->
	<link rel="stylesheet" href="assets/css/jquery-ui.custom.min.css" />
	<link rel="stylesheet" href="assets/css/chosen.min.css" />
	<link rel="stylesheet" href="assets/css/bootstrap-datepicker3.min.css" />
	<link rel="stylesheet" href="assets/css/bootstrap-timepicker.min.css" />
	<link rel="stylesheet" href="assets/css/daterangepicker.min.css" />
	<link rel="stylesheet" href="assets/css/bootstrap-datetimepicker.min.css" />
	<link rel="stylesheet" href="assets/css/bootstrap-colorpicker.min.css" />
	<!-- text fonts -->
	<link rel="stylesheet" href="assets/css/fonts.googleapis.com.css" />
	<!-- ace styles -->
	<link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />
	<link rel="stylesheet" href="assets/css/ace-skins.min.css" />
	<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />

	<link rel="stylesheet" href="bootstrap-sweetalert/lib/sweet-alert.css" />
	<script src="assets/js/ace-extra.min.js"></script>
	<script src="assets/js/jquery-2.1.4.min.js"></script>
	<script src="js/jquery.session.js"></script>
	<script src="js/moment.js"></script>
	<script src="cordova.js"></script>

	<script>
		$(function () {
			$("#nav_bar").load("common/nav_bar.html");

		});
	</script>
	<script type="text/javascript">



		$(document).ready(function () {
			//$("#txt_1").keyup();
			//$("#txt_1").keypress();
			jQuery('#txt_1').focus();

			$("#search_res").hide();
			$("#search_res_itm").hide();
			var get_date = moment().format("YYYY-MM-DD");
			//alert(get_date);
			$("#hid_date").val(get_date);

			//$('#next').addClass("hidden");
			$('#itm_name').addClass("hidden");
			$('#back').addClass("hidden");
			//$('#add_tbl').addClass("hidden");
			$('.tbl1').addClass("hidden");
			$('#com').addClass("hidden");


			$("#pay_no").prop("readonly", true);
			//Keyboard.show();




			if (!$.session.get("user_name")) {
				window.location.replace("index.html");
			} else {

				var user_name = $.session.get("user_name");
				$("#session_name").text(user_name);
				var user_id = $.session.get("user_id");


			}


		});


		function session_des() {
			//var user = $.session.get("user");
			//alert(user);	
			$.session.clear();
			//document.location.href="http://yoursite.com"+ document.getElementById('somefield');

			location.href = "index.html";
		}




	</script>



	<style>
		.input_txt_style{ 
		font-size:15pt;
		height:50px;
	    }

            .widget-header {
                border-bottom: none;
                padding-left: 5px;
            }
	    .edt_btn_style {
		display: none;
	    }
	    .loader {
		border: 10px solid #f3f3f3;
		border-radius: 50%;
		border-top: 10px solid #3498db;
		width: 30px;
		height: 30px;
		-webkit-animation: spin 2s linear infinite; /* Safari */
		animation: spin 1s linear infinite;
	    }
	    @-webkit-keyframes spin {
		0% { -webkit-transform: rotate(0deg); }
		100% { -webkit-transform: rotate(360deg); }
	    }

	    @keyframes spin {
		0% { transform: rotate(0deg); }
		100% { transform: rotate(360deg); }
	    }
	    input[type=checkbox] {
		zoom: 2;
	    }

        </style>
</head>

<body class="no-skin">


	<div id="nav_bar"></div>

	<div class="main-container ace-save-state" id="main-container">
		<script type="text/javascript">
			try {
				ace.settings.loadState('main-container')
			} catch (e) {
			}
		</script>



		<!-- /Start .main-content -->
		<div class="main-content">
			<div class="main-content-inner">
				<div class="breadcrumbs ace-save-state" id="breadcrumbs">
					<ul class="breadcrumb">
						<a href="dashboard.html"><span class="label label-xlg label-info arrowed-in-right arrowed">Back</span></a>
						<li> <i class="ace-icon fa fa-home home-icon"></i> <a href="dashboard.html"><b>Home</b></a> </li>

					</ul>
					<!-- /.breadcrumb -->
				</div>

				<!-- /Start .page-content -->
				<div class="page-content">
					<div class="row">
						<div class="col-xs-12">
							<!-- PAGE CONTENT BEGINS -->


							<!-- /Start .page-content -->

							<div class="row tbl2">
								<div class="col-xs-12">
									<!-- PAGE CONTENT BEGINS -->

									<!-- /Start .widget-box -->

									<div class="widget-box tbl2">
										<div class="widget-body">
											<div class="widget-main">
												<div class="widget-header widget-header-flat">
													<div class="row">
														<div class="col-lg-6 col-sm-6 col-xs-6">
															<h4>Invoice</h4>
														</div>

													</div>
												</div>
												<div class="space-10"></div>
												<!-- Content -->



												<input placeholder="Name" class="form-control" id="hidden_itm_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_balance" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_new_balance" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_stock_card" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_user_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_invoice_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_date" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_ref_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_stock_book" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_itm_id_model" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_model_itm_code" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_sub_total" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_ref_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_qty" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_price" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_discount" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_description" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_stock_card" style="display:none" />
												<input placeholder="Name" class="form-control" id="com_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="com_ref_id" style="display:none" />
												<input placeholder="Name" class="form-control" id="com_id_stock" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_edit_done" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_deduct_sub" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_array" style="display:none" />
												<input placeholder="Name" class="form-control" id="hidden_foc_price" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_auto"  />
												<input placeholder="Name" class="form-control" id="hid_acc_no" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_good_dis" style="display:none" />
												<input placeholder="Name" class="form-control" id="hid_cre_limit" style="display:none" />


												<div class="form-group" id="cus_name">
													<label>
														<font size="3"><b>Customer Name</b></font>
													</label>


													<div class="input-group">
														<span class="input-group-addon"><i class="fa fa-check-square-o"></i></span>
														<!--<a  data-custom-value="1" class="drop_data" href="#drop_1" data-toggle="collapse"> -->
														<input type="text" class="form-control" placeholder="Click here" id="txt_1" style="font-size:15pt;height:50px;">

														<!-- </a>-->

													</div>
													<span id="val_cus_name" style="display:none" class="formError">
														<font color="#F44336">Please Select Customer Name</font>
													</span>
													<div style="height:150px; overflow-y:auto;">
														<table class="tbl table table-striped table-bordered table-hover" border="1" id="search_res">
															<tbody>

															</tbody>
														</table>
													</div>


												</div>

												<div class="form-group" id="itm_name">

													<div class="row">
														<div class="col-lg-12 col-sm-12 col-xs-12" align="left">
															<label>
																<font size="3"><b>Item Name</b></font>
															</label>
														</div>

													</div>

													<div class="input-group">
														<span class="input-group-addon"><i class="fa fa-check-square-o"></i></span>
														<!--<a  data-custom-value="1" class="drop_data" href="#drop_2" data-toggle="collapse" > -->
														<input type="text" class="form-control" placeholder="Click here" id="txt_2" style="font-size:15pt;height:50px;">
														<!--</a>-->

													</div>
													<span id="val_itm_name" style="display:none" class="formError">
														<font color="#F44336">Please Select Item Name</font>
													</span>
													<div style="height:150px; overflow-y:auto;">
														<table class="tbl_itm table table-striped table-bordered table-hover" border="1" id="search_res_itm">

															<tbody>

															</tbody>
														</table>
													</div>


												</div>


												<div class="form-group">
													<!--<button class="btn btn-success" id="next"><i class="ace-icon fa fa-arrow-right"></i>Next</button>-->
													<button class="btn btn-danger" id="cancel"><i class="ace-icon fa fa-remove"></i>Clear</button>
													<button class="btn btn-primary" id="back"><i class="ace-icon fa fa-arrow-left"></i>Back</button>
													<!--<button class="btn btn-success btn-sm" id="add_tbl">Add To Table</button>-->
													<button class="btn btn-success" id="com"><i class="ace-icon fa fa-check"></i>Complete Invoice</button>


												</div>


											</div>
										</div>
										<!-- /.widget-main -->
									</div>
									<!-- /.widget-body -->

									<!-- /.widget-box -->
									<!-- PAGE CONTENT ENDS -->
								</div>
								<!-- /.col -->
							</div>
							<!-- /.row -->

							<!-- /End .page-content -->
							<div class="tbl1">
								<div class="row">
									<div class="col-xs-12">

										<div class="row">
											<div class="col-xs-12">
												<div class="widget-box col-md-12 col-xs-12">
													<div class="widget-body">
														<div class="widget-main col-md-12 col-xs-12">
															<div class="table-header">Available Items</div>

															<!-- div.table-responsive -->
															<!-- div.dataTables_borderWrap --><br>

															<br>
															<div class="table-responsive">
																<div class="col-xs-20">

																	<div class="col-xs-20">

																		<table class="table table-striped table-bordered table-hover">
																			<thead>
																				<th>ID</th>
																				<th style="width:15px;">Item Name</th>
																				<th>Quantity</th>
																				<th>Discount</th>
																				<th>Total Unit Price </th>

																				<th>Remove</th>



																			</thead>
																			<tbody id="TableData">

																			</tbody>
																		</table>
																	</div>
																	<div class="row pull-right">
																		<div class="col-md-12">


																			<div class="pull-right">GROSS AMOUNT(Rs)<input type="text" id="sub_total_token" class="input_txt_style"
																				 readonly=""></div>

																		</div>
																	</div>
																	<!--<div class="row pull-right"><div class="col-md-12">


										<div class="pull-right">TOTAL FOC(Rs)<input type="text"  id="sub_total_foc" class="input_txt_style" readonly="" value="0"></div>

									    </div></div>-->
																	<div class="row pull-right">
																		<div class="col-md-12">


																			<div class="pull-right">TOTAL DISCOUNT(Rs)<input type="text" id="sub_total_dis" class="input_txt_style"
																				 readonly=""></div>

																		</div>
																	</div>
																	<!--<div class="row pull-right"><div class="col-md-12">


										<div class="pull-right">TOTAL SALES RETURN(Rs)<input type="text" id="sub_total_return"  class="input_txt_style" readonly="" value="0"></div>

									    </div></div>-->
																</div>
															</div>


														</div>
													</div>
												</div>

											</div>
										</div>








										<!-- /.row -->
									</div>
									<!-- /.page-content -->
								</div>
								<!-- /.row -->
							</div>



							<!-- /.row -->


							<!-- /.widget-body -->





							<!-- /.widget-box -->
							<!-- PAGE CONTENT ENDS -->
						</div>
						<!-- /.col -->
					</div>
					<!-- /.row -->


				</div>
				<!-- /End .page-content -->
			</div>
		</div>
		<!-- /End .main-content -->

		<div class="footer">
			<div class="footer-inner">
				<div class="footer-content"> </div>
			</div>
		</div>
		<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse"> <i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
		</a> </div>
	<!-- /.main-container -->

	<div id="model_item" class="modal fade" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">

					<h3 class="smaller lighter blue no-margin"><span>Item Details</span> </h3>
				</div>
				<div class="modal-body">
					<table class="table table-bordered">

						<tr>
							<td>
								<font size="3">Available Stock</font>
							</td>
							<td colspan="2"><input type="text" class="form-control input_txt_style" id="mod_ava" readonly=""></td>
						</tr>
						<tr>
							<td>
								<font size="3">Item Name</font>
							</td>
							<td colspan="2"><input type="text" class="form-control input_txt_style" id="mod_itmname" readonly=""></td>
						</tr>
						<tr>
							<td>
								<font size="3">Item Code</font>
							</td>
							<td colspan="2"><input type="text" class="form-control input_txt_style" id="mod_itmcode" readonly=""></td>
						</tr>
						<tr>
							<td>
								<font size="3">Quantity</font>
							</td>
							<td colspan="2"><input type="number" class="form-control input_txt_style" id="mod_qty" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"></td>
						</tr>
						<span id="val_qty" style="display:none" class="formError">
							<font color="#F44336">Qty you entered not in stock</font>
						</span>
						<span id="val_qty_ex" style="display:none" class="formError">
							<font color="#F44336">Please Enter Qty</font>
						</span>
						<!--<tr><td>Free Issue</td><td><span id="mod_free"></span></td></tr>-->
						<tr>
							<td>
								<font size="3">Discount(%)</font>
							</td>
							<td><input type="number" id="mod_dis" class="form-control input_txt_style"></td>
						</tr>
						<tr>
							<td>
								<font size="3">unit Price</font>
							</td>
							<td colspan="2"><input type="number" id="mod_price" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
								 class="form-control input_txt_style" readonly=""></td>
						</tr>


					</table>



				</div>
				<div class="modal-footer">
					<button class="btn btn-xlg btn-success" id="done" style="margin-right:5px;"> <i class="ace-icon fa fa-check"></i>
						Done </button>
					<button class="btn btn-xlg btn-danger pull-right cancel_btn" data-dismiss="modal"><i class="ace-icon fa fa-close"></i>Cancel</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<div id="payment_detail" class="modal fade" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">

					<h3 class="smaller lighter blue no-margin"><span>Payment Details</span> </h3>
				</div>
				<div class="modal-body">
					<table class="table table-bordered">

						<tr>
							<td colspan="2">
								<font size="3">Net Amount</font>
							</td>
							<td colspan="2"><input type="text" class="form-control input_txt_style" id="gross" readonly=""></td>
						</tr>
						<!--<tr><td colspan="2"><font size="3">Discount</font></td><td colspan="4"><input type="text" class="form-control input_txt_style" id="" readonly=""></td></tr>-->
						<tr>
							<td colspan="4">
								<h5><b>Payment Method</b></h5>
							</td>
						</tr>
						<tr>
							<td colspan="2">
								<font size="3">Cash</font>
							</td>
							<td colspan="2"><input type="number" class="form-control input_txt_style" id="pay_cash"></td>
						</tr>
						<tr>
							<td>
								<font size="3">Cheque No</font>
							</td>
							<td><input type="text" class="form-control input_txt_style" id="pay_no"></td>
							<td style="vertical-align: middle;">
								<font size="3">Cheque Amount</font>
							</td>
							<td style="vertical-align: middle;"><input type="number" class="form-control input_txt_style" id="pay_amount"
								 oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"></td>
						</tr>


						<tr>
							<td>
								<font size="3">Cheque Date</font>
							</td>
							<td><input type="text" class="form-control input_txt_style date-picker" id="pay_date" data-date-format="yyyy-mm-dd"></td>
							<td>
								<font size="3">Bank</font>
							</td>
							<td><input type="text" class="form-control input_txt_style" id="bank"></td>
						</tr>
						<tr>
							<td colspan="4">
								<h5><b>Payment Summery</b></h5>
							</td>
						</tr>
						<tr>
							<td colspan="2">
								<font size="3">Total Payment</font>
							</td>
							<td colspan="2"><input type="text" id="pay_tot" readonly="" class="form-control input_txt_style"></td>
						</tr>
						<tr>
							<td colspan="2">
								<font size="3">Due Balance</font>
							</td>
							<td colspan="2"><input type="text" readonly="" id="pay_bal" class="form-control input_txt_style"></td>
						</tr>
						<!--<tr><td colspan="2"><font size="3">Credit Limit</font></td><td colspan="2"><input type="text" readonly="" id="cre_limt" class="form-control input_txt_style"></td></tr>-->


					</table>



				</div>
				<div class="modal-footer">
					<button class="btn btn-xlg btn-success" id="pay" style="margin-right:5px;"> <i class="ace-icon fa fa-check"></i>
						Pay </button>
					<button class="btn btn-xlg btn-danger pull-right cancel" data-dismiss="modal"><i class="ace-icon fa fa-close"></i>Cancel</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>


	<script type="text/javascript">
		if ('ontouchstart' in document.documentElement)
			document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
	</script>
	<script src="assets/js/jquery-ui.custom.min.js"></script>
	<script src="assets/js/jquery.ui.touch-punch.min.js"></script>
	<script src="assets/js/chosen.jquery.min.js"></script>
	<script src="assets/js/spinbox.min.js"></script>
	<script src="assets/js/bootstrap-datepicker.min.js"></script>
	<script src="assets/js/bootstrap-timepicker.min.js"></script>
	<script src="assets/js/moment.min.js"></script>
	<script src="assets/js/daterangepicker.min.js"></script>
	<script src="assets/js/bootstrap-datetimepicker.min.js"></script>
	<script src="assets/js/bootstrap-colorpicker.min.js"></script>
	<script src="assets/js/jquery.knob.min.js"></script>
	<script src="assets/js/autosize.min.js"></script>
	<script src="assets/js/jquery.inputlimiter.min.js"></script>
	<script src="assets/js/jquery.maskedinput.min.js"></script>
	<script src="assets/js/bootstrap-tag.min.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/jquery-ui.custom.min.js"></script>
	<script src="assets/js/jquery.ui.touch-punch.min.js"></script>
	<script src="assets/js/jquery.easypiechart.min.js"></script>
	<script src="assets/js/jquery.sparkline.index.min.js"></script>
	<script src="assets/js/jquery.flot.min.js"></script>
	<script src="assets/js/jquery.flot.pie.min.js"></script>
	<script src="assets/js/jquery.flot.resize.min.js"></script>
	<!-- ace scripts -->
	<script src="assets/js/ace-elements.min.js"></script>
	<script src="assets/js/ace.min.js"></script>
	<!-- page specific plugin scripts -->
	<script src="assets/js/jquery.dataTables.min.js"></script>
	<script src="assets/js/jquery.dataTables.bootstrap.min.js"></script>
	<script src="assets/js/dataTables.buttons.min.js"></script>
	<script src="assets/js/buttons.flash.min.js"></script>
	<script src="assets/js/buttons.html5.min.js"></script>
	<script src="assets/js/buttons.print.min.js"></script>
	<script src="assets/js/buttons.colVis.min.js"></script>
	<script src="assets/js/dataTables.select.min.js"></script>
	<script src="bootstrap-sweetalert/lib/sweet-alert.min.js"></script>
	<script src="common/common.js"></script>
	<!-- inline scripts related to this page -->

	<!-- inline scripts related to this page -->
	<script type="text/javascript">
		// jQuery(function ($) {
		$('#id-disable-check').on('click', function () {
			var inp = $('#form-input-readonly').get(0);
			if (inp.hasAttribute('disabled')) {
				inp.setAttribute('readonly', 'true');
				inp.removeAttribute('disabled');
				inp.value = "This text field is readonly!";
			}
			else {
				inp.setAttribute('disabled', 'disabled');
				inp.removeAttribute('readonly');
				inp.value = "This text field is disabled!";
			}
		});


		if (!ace.vars['touch']) {
			$('.chosen-select').chosen({ allow_single_deselect: true });
			//resize the chosen on window resize

			$(window)
				.off('resize.chosen')
				.on('resize.chosen', function () {
					$('.chosen-select').each(function () {
						var $this = $(this);
						$this.next().css({ 'width': $this.parent().width() });
					})
				}).trigger('resize.chosen');
			//resize chosen on sidebar collapse/expand
			$(document).on('settings.ace.chosen', function (e, event_name, event_val) {
				if (event_name != 'sidebar_collapsed')
					return;
				$('.chosen-select').each(function () {
					var $this = $(this);
					$this.next().css({ 'width': $this.parent().width() });
				})
			});


			$('#chosen-multiple-style .btn').on('click', function (e) {
				var target = $(this).find('input[type=radio]');
				var which = parseInt(target.val());
				if (which == 2)
					$('#form-field-select-4').addClass('tag-input-style');
				else
					$('#form-field-select-4').removeClass('tag-input-style');
			});
		}


		$('[data-rel=tooltip]').tooltip({ container: 'body' });
		$('[data-rel=popover]').popover({ container: 'body' });

		autosize($('textarea[class*=autosize]'));

		$('textarea.limited').inputlimiter({
			remText: '%n character%s remaining...',
			limitText: 'max allowed : %n.'
		});

		$.mask.definitions['~'] = '[+-]';
		$('.input-mask-date').mask('99/99/9999');
		$('.input-mask-phone').mask('(999) 999-9999');
		$('.input-mask-eyescript').mask('~9.99 ~9.99 999');
		$(".input-mask-product").mask("a*-999-a999", {
			placeholder: " ", completed: function () {
				alert("You typed the following: " + this.val());
			}
		});



		$("#input-size-slider").css('width', '200px').slider({
			value: 1,
			range: "min",
			min: 1,
			max: 8,
			step: 1,
			slide: function (event, ui) {
				var sizing = ['', 'input-sm', 'input-lg', 'input-mini', 'input-small', 'input-medium', 'input-large', 'input-xlarge', 'input-xxlarge'];
				var val = parseInt(ui.value);
				$('#form-field-4').attr('class', sizing[val]).attr('placeholder', '.' + sizing[val]);
			}
		});

		$("#input-span-slider").slider({
			value: 1,
			range: "min",
			min: 1,
			max: 12,
			step: 1,
			slide: function (event, ui) {
				var val = parseInt(ui.value);
				$('#form-field-5').attr('class', 'col-xs-' + val).val('.col-xs-' + val);
			}
		});



		//"jQuery UI Slider"
		//range slider tooltip example
		$("#slider-range").css('height', '200px').slider({
			orientation: "vertical",
			range: true,
			min: 0,
			max: 100,
			values: [17, 67],
			slide: function (event, ui) {
				var val = ui.values[$(ui.handle).index() - 1] + "";

				if (!ui.handle.firstChild) {
					$("<div class='tooltip right in' style='display:none;left:16px;top:-6px;'><div class='tooltip-arrow'></div><div class='tooltip-inner'></div></div>")
						.prependTo(ui.handle);
				}
				$(ui.handle.firstChild).show().children().eq(1).text(val);
			}
		}).find('span.ui-slider-handle').on('blur', function () {
			$(this.firstChild).hide();
		});


		$("#slider-range-max").slider({
			range: "max",
			min: 1,
			max: 10,
			value: 2
		});

		$("#slider-eq > span").css({ width: '90%', 'float': 'left', margin: '15px' }).each(function () {
			// read initial values from markup and remove that
			var value = parseInt($(this).text(), 10);
			$(this).empty().slider({
				value: value,
				range: "min",
				animate: true

			});
		});

		$("#slider-eq > span.ui-slider-purple").slider('disable');//disable third item


		$('#id-input-file-1 , #id-input-file-2').ace_file_input({
			no_file: 'No File ...',
			btn_choose: 'Choose',
			btn_change: 'Change',
			droppable: false,
			onchange: null,
			thumbnail: false //| true | large
			//whitelist:'gif|png|jpg|jpeg'
			//blacklist:'exe|php'
			//onchange:''
			//
		});
		//pre-show a file name, for example a previously selected file
		//$('#id-input-file-1').ace_file_input('show_file_list', ['myfile.txt'])


		$('#id-input-file-3').ace_file_input({
			style: 'well',
			btn_choose: 'Drop files here or click to choose',
			btn_change: null,
			no_icon: 'ace-icon fa fa-cloud-upload',
			droppable: true,
			thumbnail: 'small'//large | fit
			//,icon_remove:null//set null, to hide remove/reset button
			/**,before_change:function(files, dropped) {
			 //Check an example below
			 //or examples/file-upload.html
			 return true;
			 }*/
			/**,before_remove : function() {
			 return true;
			 }*/
			,
			preview_error: function (filename, error_code) {
				//name of the file that failed
				//error_code values
				//1 = 'FILE_LOAD_FAILED',
				//2 = 'IMAGE_LOAD_FAILED',
				//3 = 'THUMBNAIL_FAILED'
				//alert(error_code);
			}

		}).on('change', function () {
			//console.log($(this).data('ace_input_files'));
			//console.log($(this).data('ace_input_method'));
		});


		//$('#id-input-file-3')
		//.ace_file_input('show_file_list', [
		//{type: 'image', name: 'name of image', path: 'http://path/to/image/for/preview'},
		//{type: 'file', name: 'hello.txt'}
		//]);




		//dynamically change allowed formats by changing allowExt && allowMime function
		$('#id-file-format').removeAttr('checked').on('change', function () {
			var whitelist_ext, whitelist_mime;
			var btn_choose
			var no_icon
			if (this.checked) {
				btn_choose = "Drop images here or click to choose";
				no_icon = "ace-icon fa fa-picture-o";

				whitelist_ext = ["jpeg", "jpg", "png", "gif", "bmp"];
				whitelist_mime = ["image/jpg", "image/jpeg", "image/png", "image/gif", "image/bmp"];
			}
			else {
				btn_choose = "Drop files here or click to choose";
				no_icon = "ace-icon fa fa-cloud-upload";

				whitelist_ext = null;//all extensions are acceptable
				whitelist_mime = null;//all mimes are acceptable
			}
			var file_input = $('#id-input-file-3');
			file_input
				.ace_file_input('update_settings',
					{
						'btn_choose': btn_choose,
						'no_icon': no_icon,
						'allowExt': whitelist_ext,
						'allowMime': whitelist_mime
					})
			file_input.ace_file_input('reset_input');

			file_input
				.off('file.error.ace')
				.on('file.error.ace', function (e, info) {
					//console.log(info.file_count);//number of selected files
					//console.log(info.invalid_count);//number of invalid files
					//console.log(info.error_list);//a list of errors in the following format

					//info.error_count['ext']
					//info.error_count['mime']
					//info.error_count['size']

					//info.error_list['ext']  = [list of file names with invalid extension]
					//info.error_list['mime'] = [list of file names with invalid mimetype]
					//info.error_list['size'] = [list of file names with invalid size]


					/**
					 if( !info.dropped ) {
					 //perhapse reset file field if files have been selected, and there are invalid files among them
					 //when files are dropped, only valid files will be added to our file array
					 e.preventDefault();//it will rest input
					 }
					 */


					//if files have been selected (not dropped), you can choose to reset input
					//because browser keeps all selected files anyway and this cannot be changed
					//we can only reset file field to become empty again
					//on any case you still should check files with your server side script
					//because any arbitrary file can be uploaded by user and it's not safe to rely on browser-side measures
				});


			/**
			 file_input
			 .off('file.preview.ace')
			 .on('file.preview.ace', function(e, info) {
			 console.log(info.file.width);
			 console.log(info.file.height);
			 e.preventDefault();//to prevent preview
			 });
			 */

		});

		$('#spinner1').ace_spinner({ value: 0, min: 0, max: 200, step: 10, btn_up_class: 'btn-info', btn_down_class: 'btn-info' })
			.closest('.ace-spinner')
			.on('changed.fu.spinbox', function () {
				//console.log($('#spinner1').val())
			});
		$('#spinner2').ace_spinner({ value: 0, min: 0, max: 10000, step: 100, touch_spinner: true, icon_up: 'ace-icon fa fa-caret-up bigger-110', icon_down: 'ace-icon fa fa-caret-down bigger-110' });
		$('#spinner3').ace_spinner({ value: 0, min: -100, max: 100, step: 10, on_sides: true, icon_up: 'ace-icon fa fa-plus bigger-110', icon_down: 'ace-icon fa fa-minus bigger-110', btn_up_class: 'btn-success', btn_down_class: 'btn-danger' });
		$('#spinner4').ace_spinner({ value: 0, min: -100, max: 100, step: 10, on_sides: true, icon_up: 'ace-icon fa fa-plus', icon_down: 'ace-icon fa fa-minus', btn_up_class: 'btn-purple', btn_down_class: 'btn-purple' });

		//$('#spinner1').ace_spinner('disable').ace_spinner('value', 11);
		//or
		//$('#spinner1').closest('.ace-spinner').spinner('disable').spinner('enable').spinner('value', 11);//disable, enable or change value
		//$('#spinner1').closest('.ace-spinner').spinner('value', 0);//reset to 0


		//datepicker plugin
		//link
		$('.date-picker').datepicker({
			autoclose: true,
			todayHighlight: true
		})
			//show datepicker when clicking on the icon
			.next().on(ace.click_event, function () {
				$(this).prev().focus();
			});

		//or change it into a date range picker
		$('.input-daterange').datepicker({ autoclose: true });


		//to translate the daterange picker, please copy the "examples/daterange-fr.js" contents here before initialization
		$('input[name=date-range-picker]').daterangepicker({
			'applyClass': 'btn-sm btn-success',
			'cancelClass': 'btn-sm btn-default',
			locale: {
				applyLabel: 'Apply',
				cancelLabel: 'Cancel',
			}
		})
			.prev().on(ace.click_event, function () {
				$(this).next().focus();
			});


		$('#timepicker1').timepicker({
			minuteStep: 1,
			showSeconds: true,
			showMeridian: false,
			disableFocus: true,
			icons: {
				up: 'fa fa-chevron-up',
				down: 'fa fa-chevron-down'
			}
		}).on('focus', function () {
			$('#timepicker1').timepicker('showWidget');
		}).next().on(ace.click_event, function () {
			$(this).prev().focus();
		});




		if (!ace.vars['old_ie'])
			$('#date-timepicker1').datetimepicker({
				//format: 'MM/DD/YYYY h:mm:ss A',//use this option to display seconds
				icons: {
					time: 'fa fa-clock-o',
					date: 'fa fa-calendar',
					up: 'fa fa-chevron-up',
					down: 'fa fa-chevron-down',
					previous: 'fa fa-chevron-left',
					next: 'fa fa-chevron-right',
					today: 'fa fa-arrows ',
					clear: 'fa fa-trash',
					close: 'fa fa-times'
				}
			}).next().on(ace.click_event, function () {
				$(this).prev().focus();
			});


		$('#colorpicker1').colorpicker();
		//$('.colorpicker').last().css('z-index', 2000);//if colorpicker is inside a modal, its z-index should be higher than modal'safe

		$('#simple-colorpicker-1').ace_colorpicker();
		//$('#simple-colorpicker-1').ace_colorpicker('pick', 2);//select 2nd color
		//$('#simple-colorpicker-1').ace_colorpicker('pick', '#fbe983');//select #fbe983 color
		//var picker = $('#simple-colorpicker-1').data('ace_colorpicker')
		//picker.pick('red', true);//insert the color if it doesn't exist


		$(".knob").knob();


		var tag_input = $('#form-field-tags');
		try {
			tag_input.tag(
				{
					placeholder: tag_input.attr('placeholder'),
					//enable typeahead by specifying the source array
					source: ace.vars['US_STATES'], //defined in ace.js >> ace.enable_search_ahead
					/**
					 //or fetch data from database, fetch those that match "query"
					 source: function(query, process) {
					 $.ajax({url: 'remote_source.php?q='+encodeURIComponent(query)})
					 .done(function(result_items){
					 process(result_items);
					 });
					 }
					 */
				}
			)

			//programmatically add/remove a tag
			var $tag_obj = $('#form-field-tags').data('tag');
			$tag_obj.add('Programmatically Added');

			var index = $tag_obj.inValues('some tag');
			$tag_obj.remove(index);
		}
		catch (e) {
			//display a textarea for old IE, because it doesn't support this plugin or another one I tried!
			tag_input.after('<textarea id="' + tag_input.attr('id') + '" name="' + tag_input.attr('name') + '" rows="3">' + tag_input.val() + '</textarea>').remove();
			//autosize($('#form-field-tags'));
		}


		/////////
		$('#modal-form input[type=file]').ace_file_input({
			style: 'well',
			btn_choose: 'Drop files here or click to choose',
			btn_change: null,
			no_icon: 'ace-icon fa fa-cloud-upload',
			droppable: true,
			thumbnail: 'large'
		})

		//chosen plugin inside a modal will have a zero width because the select element is originally hidden
		//and its width cannot be determined.
		//so we set the width after modal is show
		$('#modal-form').on('shown.bs.modal', function () {
			if (!ace.vars['touch']) {
				$(this).find('.chosen-container').each(function () {
					$(this).find('a:first-child').css('width', '210px');
					$(this).find('.chosen-drop').css('width', '210px');
					$(this).find('.chosen-search input').css('width', '200px');
				});
			}
		})
	    /**
	     //or you can activate the chosen plugin after modal is shown
	     //this way select element becomes visible with dimensions and chosen works as expected
	     $('#modal-form').on('shown', function () {
	     $(this).find('.modal-chosen').chosen();
	     })
	     */



		$(document).one('ajaxloadstart.page', function (e) {
			autosize.destroy('textarea[class*=autosize]')

			$('.limiterBox,.autosizejs').remove();
			$('.daterangepicker.dropdown-menu,.colorpicker.dropdown-menu,.bootstrap-datetimepicker-widget.dropdown-menu').remove();
		});

	    // });
	</script>
	<script>
		document.addEventListener('deviceready', load_data_default);


		$("#txt_1").keyup(function () {
			//$('#thisdiv').load(invoice.html +  ' #thisdiv');
			$("#search_res").show();
			$(".tbl > tbody").html("");
			var search_key = $('#txt_1').val();
			//alert(search_key);
			auto_complete_cus(search_key);

		});



		/*******************************load first 50 data********************************************************/
		function load_data_default() {
			Keyboard.show();
			$("#search_res").show();

			//alert("hellow");


			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {

				transaction.executeSql("SELECT * FROM cus_reg LIMIT 20", [], function (tx, results) {
					//transaction.executeSql("SELECT * FROM stock_card WHERE (descrip LIKE ?)", ["%" + search_key + "%"], function (tx, results) {

					var len = results.rows.length, i;
					//alert(len);
					if (len == 0) {

						$("#search_res tbody").append('<tr><td colspan="8"><font color="black" size="4">No Data Found in database</font></td></tr>');
					} else {

						for (i = 0; i < len; i++) {
							$("#search_res tbody").append("<tr>\n\
				<td class='row_data_sub'><a class='anc_data' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).first_name + "</font></a></td>\n\
				</tr>");


						}

						$('.anc_data').click(function () {



							var id = $(this).data("custom-value");

							$("#hid_user_id").val(id);
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM cus_reg  WHERE id=? ";
								transaction.executeSql(executeQuery, [id],
									function (tx, results) {
										var len = results.rows.length, i;

										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											$("#txt_1").val(results.rows.item(i).first_name);
											$("#hid_acc_no").val(results.rows.item(i).nic);
											$("#search_res").hide();
										}
									}, null);
							});

						});


						$('.anc_data').click(function () {

							$("#txt_2").focus();
							//validate_cus_name();
							//if (validate_customer_name) {
							$('#itm_name').removeClass("hidden");
							$('#back').removeClass("hidden");
							$('#cus_name').addClass("hidden");
							$('#next').addClass("hidden");
							$("#search_res_itm").hide();
							$('#search_res_itm tbody').remove();
							/*var table = $('#search_res_itm').DataTable();
							 table.clear()*/
							load_item_token_tbl();
							load_first_itm_list();

							var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
							myDB.transaction(function (transaction) {
								transaction.executeSql('SELECT * FROM increment_inv ', [], function (tx, results) {
									var len = results.rows.length, i;
									//alert(len);
									for (i = 0; i < len; i++) {
										$("#hid_invoice_id").val(results.rows.item(i).inv_id);
										$("#hid_ref_id").val(results.rows.item(i).ref);
										$("#hid_auto").val(results.rows.item(i).auto);


									}
								}, null);
							});



							//}

						});

					}
				}, null);
			});


		}


		/*******************************load first 50 data********************************************************/


		function auto_complete_cus(search_key) {
			//var search_key = $('.inv_cus').val();
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {
				var agent_id = $.session.get("user_id");
				transaction.executeSql("SELECT * FROM cus_reg  WHERE (cus_reg.first_name LIKE ?) OR (cus_reg.last_name LIKE ?) ", [(search_key + "%"), (search_key + "%")], function (tx, results) {
					//transaction.executeSql("SELECT * FROM stock_card WHERE (descrip LIKE ?)", ["%" + search_key + "%"], function (tx, results) {

					var len = results.rows.length, i;
					//alert(len);
					if (len == 0) {

						$("#search_res tbody").append('<tr><td colspan="8"><font color="black" size="4">No Data Found in database</font></td></tr>');
					} else {

						for (i = 0; i < len; i++) {
							$("#search_res tbody").append("<tr>\n\
				<td class='row_data_sub'><a class='anc_data' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).first_name + "</font></a></td>\n\
				</tr>");





						}
						$('.anc_data').click(function () {

							//$('#next').removeClass("hidden");

							var id = $(this).data("custom-value");
							//alert(data_name);
							//$("#txt_1").val(data_name);
							$("#hid_user_id").val(id);
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM cus_reg  WHERE id=? ";
								transaction.executeSql(executeQuery, [id],
									function (tx, results) {
										var len = results.rows.length, i;
										//$("#rowCount").append(len);
										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											$("#txt_1").val(results.rows.item(i).first_name);
											$("#hid_acc_no").val(results.rows.item(i).nic);
											$("#search_res").hide();
										}
									}, null);
							});

						});

						$('.anc_data').click(function () {

							$("#txt_2").focus();
							//validate_cus_name();
							//if (validate_customer_name) {
							$('#itm_name').removeClass("hidden");
							$('#back').removeClass("hidden");
							$('#cus_name').addClass("hidden");
							$('#next').addClass("hidden");

							load_item_token_tbl();
							load_first_itm_list();

							var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
							myDB.transaction(function (transaction) {
								transaction.executeSql('SELECT * FROM increment_inv ', [], function (tx, results) {
									var len = results.rows.length, i;
									//alert(len);
									for (i = 0; i < len; i++) {
										$("#hid_invoice_id").val(results.rows.item(i).inv_id);
										$("#hid_ref_id").val(results.rows.item(i).ref);
										$("#hid_auto").val(results.rows.item(i).auto);


									}
								}, null);
							});



							//}

						});



					}

				}, null);
			});

		}

		$("#txt_2").keyup(function () {
			$("#search_res_itm").show();
			$(".tbl_itm > tbody").html("");
			var search_key = $('#txt_2').val();
			//alert(search_key);
			auto_complete_itm(search_key)

		});

		/******************************load default item 50**************************************************************************************/
		function load_first_itm_list() {
			$("#txt_2").focus();
			Keyboard.show();

			var tbldata = '';
			$("#search_res_itm").show();
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {

				transaction.executeSql("SELECT * FROM stock_card LIMIT 20", [], function (tx, results) {
					//transaction.executeSql("SELECT * FROM stock_card WHERE (descrip LIKE ?)", ["%" + search_key + "%"], function (tx, results) {
					//$("#search_res_itm").append().html("");
					var len = results.rows.length, i;
					if (len == 0) {
						$("#search_res_itm").html('').append('<tr><td colspan="8"><font color="black" size="4">No Data Found in database</font></td></tr>');
					} else {

						for (i = 0; i < len; i++) {
							tbldata += "<tr>\n\
				<td class='row_data_sub'><a class='anc_data_itm' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).descrip + "</font></a></td>\n\
				<td class='row_data_sub'><a class='anc_data_itm' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).stock_card + "</font></a></td>\n\
				</tr>";


							//$("#hidden_itm_id").val(results.rows.item(i).id);


						}
						$("#search_res_itm").html('').append(tbldata);
						$('.anc_data_itm').click(function () {

							//$('#add_tbl').removeClass("hidden");

							var data_id = $(this).data("custom-value");
							//alert(data_name);
							$("#hidden_itm_id").val(data_id);
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM stock_card  WHERE id=? ";
								transaction.executeSql(executeQuery, [data_id],
									function (tx, results) {
										var len = results.rows.length, i;
										//$("#rowCount").append(len);
										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											$("#txt_2").val(results.rows.item(i).descrip);
											$("#search_res_itm").hide();
										}
									}, null);
							});

						});


						/*******************************************load model start*************************************************************/

						$(".anc_data_itm").click(function () {
							//alert("test");
							$("#mod_qty").focus();
							Keyboard.show();
							$('#mod_qty').val('');


							var itm_id = $("#hidden_itm_id").val();




							$('#model_item').modal({ backdrop: 'static', keyboard: false });
							$('#done').removeClass("hidden");
							//$('#mod_qty').focus();
							var itm_id = $("#hidden_itm_id").val();




							var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM stock_card WHERE id=? ";
								transaction.executeSql(executeQuery, [itm_id],
									function (tx, results) {
										var len = results.rows.length, i;
										//alert(len);
										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											//$("#mod_dis").val(results.rows.item(i).disamt);



											$("#mod_price").val(results.rows.item(i).sales_p_max);
											$("#hid_stock_card").val(results.rows.item(i).stock_card);
											$("#mod_itmcode").val(results.rows.item(i).stock_card);
											$("#mod_itmname").val(results.rows.item(i).descrip);
											//$("#mod_dis").val(results.rows.item(i).disamt);

											var stock_book_validation = results.rows.item(i).stock_book;



										}


										myDB.transaction(function (transaction) {
											var itm_code = $("#hid_stock_card").val();
											// alert(itm_code);
											var executeQuery = "SELECT stock_card.id,stock_card.descrip,sum(stock.dr_qty) as dr, sum(stock.cr_qty) as cr FROM stock INNER JOIN stock_card ON stock.stock_card=stock_card.stock_card WHERE stock.stock_card=? GROUP BY stock.stock_card";
											transaction.executeSql(executeQuery, [itm_code],
												function (tx, results) {
													var len = results.rows.length, i;
													//alert(len);
													if (len == 0) {
														$('#mod_ava').val("0");
													} else {
														for (i = 0; i < len; i++) {
															var dr = results.rows.item(i).dr;
															var cr = results.rows.item(i).cr;
															var blance = dr - cr;
															//alert(blance);
															$('#mod_ava').val(blance);


														}
													}
												}, null);
										});






									}, null);
							});



						});




						/*****************************************************load model end*******************************************************/




					}

				}, null);
			});

		}
		/******************************load default item 50**************************************************************************************/

		function auto_complete_itm(search_key) {
			var tbldata = '';
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {
				// alert("3");
				transaction.executeSql("SELECT * FROM stock_card  WHERE (stock_card.descrip LIKE ?) OR (stock_card.stock_card LIKE ?)", [(search_key + "%"), (search_key + "%")], function (tx, results) {
					//transaction.executeSql("SELECT * FROM stock_card WHERE (descrip LIKE ?)", ["%" + search_key + "%"], function (tx, results) {

					var len = results.rows.length, i;
					if (len == 0) {
						$("#search_res_itm").html('').append('<tr><td colspan="8"><font color="black" size="4">No Data Found in database</font></td></tr>');
					} else {

						for (i = 0; i < len; i++) {
							tbldata += "<tr>\n\
				<td class='row_data_sub'><a class='anc_data_itm' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).descrip + "</font></a></td>\n\
				<td class='row_data_sub'><a class='anc_data_itm' data-custom-value='" + results.rows.item(i).id + "' style='width:100%; height:100%; display:inline-block;'><font color='black' size='4'>" + results.rows.item(i).stock_card + "</font></a></td>\n\
				</tr>";


							//$("#hidden_itm_id").val(results.rows.item(i).id);


						}
						$("#search_res_itm").html('').append(tbldata);
						$('.anc_data_itm').click(function () {

							//$('#add_tbl').removeClass("hidden");

							var data_id = $(this).data("custom-value");
							//alert(data_name);
							$("#hidden_itm_id").val(data_id);
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM stock_card  WHERE id=? ";
								transaction.executeSql(executeQuery, [data_id],
									function (tx, results) {
										var len = results.rows.length, i;
										//$("#rowCount").append(len);
										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											$("#txt_2").val(results.rows.item(i).descrip);
											$("#hid_stock_book").val(results.rows.item(i).stock_book);
											$("#search_res_itm").hide();
										}
									}, null);
							});

						});


						/*******************************************load model start*************************************************************/

						$(".anc_data_itm").click(function () {
							$("#mod_qty").focus();
							Keyboard.show();
							$('#mod_qty').val('');


							//$('#model_item').modal('show');
							$('#model_item').modal({ backdrop: 'static', keyboard: false })
							$('#done').removeClass("hidden");
							//$('#mod_qty').focus();
							var itm_id = $("#hidden_itm_id").val();




							var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
							myDB.transaction(function (transaction) {
								var executeQuery = "SELECT * FROM stock_card  WHERE id=? ";
								transaction.executeSql(executeQuery, [itm_id],
									function (tx, results) {
										var len = results.rows.length, i;
										//$("#rowCount").append(len);
										for (i = 0; i < len; i++) {
											//$("#TableData").append("<tr><td>" + results.rows.item(i).id + "</td><td>" + results.rows.item(i).title + "</td><td>" + results.rows.item(i).desc + "</td></tr>");
											//$("#mod_dis").val(results.rows.item(i).disamt);

											$("#mod_price").val(results.rows.item(i).units);
											$("#hid_stock_card").val(results.rows.item(i).stock_card);
											$("#mod_itmcode").val(results.rows.item(i).stock_card);
											$("#mod_itmname").val(results.rows.item(i).descrip);
											//$("#mod_dis").val(results.rows.item(i).disamt);
											var stock_book_validation = results.rows.item(i).stock_book;
										}


										myDB.transaction(function (transaction) {
											var itm_code = $("#hid_stock_card").val();
											var executeQuery = "SELECT stock_card.id,stock_card.descrip,sum(stock.dr_qty) as dr, sum(stock.cr_qty) as cr FROM stock INNER JOIN stock_card ON stock.stock_card=stock_card.stock_card WHERE stock.stock_card=? GROUP BY stock.stock_card";
											transaction.executeSql(executeQuery, [itm_code],
												function (tx, results) {
													var len = results.rows.length, i;
													//alert(len);

													for (i = 0; i < len; i++) {
														var dr = results.rows.item(i).dr;
														var cr = results.rows.item(i).cr;
														var blance = dr - cr;
														//alert(blance);
														$('#mod_ava').val(blance);


													}
												}, null);
										});






									}, null);
							});





						});




						/*****************************************************load model end*******************************************************/




					}

				}, null);
			});

		}

	</script>
	<script>

		$('.form-control').focusin(function () {
			$('.formError').fadeOut();
		});

		function clear() {
			//$(".tbl > tbody").html("");
			//$("#txt_1").focus();
			$('#txt_1').val('');
			$('#txt_2').val('');
			//$('#add_tbl').addClass("hidden");
		}


		function clear_validation_masg() {
			$('#val_first_name').fadeOut();
		}

		function clear_validation_masg_qty() {
			$('#val_qty_ex').fadeOut();
		}

		function clear_validation_masg_model() {
			$('#val_itm_name_model').fadeOut();
		}


		function display_error_msg_qty() {

			if ($('#mod_qty').val() === '') {

				$('#val_qty_ex').fadeIn();
			}
		}


		function display_error_msg() {

			if ($('#txt_1').val() === '') {

				$('#val_cus_name').fadeIn();
			}
		}


		var validate_customer_name = true;
		function validate_cus_name() {



			if ($('#txt_1').val() === '') {
				validate_customer_name = false;
				$('#val_cus_name').fadeIn();
				display_error_msg();
				scrollTo(0, 0);
			} else {
				validate_customer_name = true;
				clear_validation_masg();
			}
		}



		var validate_qty = true;
		function validate_mod_qty() {



			if ($('#mod_qty').val() === '') {
				validate_qty = false;
				$('#val_qty_ex').fadeIn();
				display_error_msg_qty();
				scrollTo(0, 0);
			} else {
				validate_qty = true;
				clear_validation_masg_qty();
			}
		}







		$("#cancel").click(function () {
			clear();
		});

		$(".cancel_btn").click(function () {
			$('#txt_2').val('');
			//$("#search_res_itm").hide();
			$('#search_res_itm tbody').remove();
			load_first_itm_list();
		});

		$("#back").click(function () {
			$("#txt_1").focus();
			Keyboard.show();
			$('#itm_name').addClass("hidden");
			$('#back').addClass("hidden");
			$('#cus_name').removeClass("hidden");
			$('#next').removeClass("hidden");
			$('#txt_1').val('');
			$('#search_res_itm tbody').remove();
			$('#com').addClass("hidden");
			$('.tbl1').addClass("hidden");
			load_data_default();
		});


		/************************************************qty validation**********************************************************************/

		$('#mod_qty').keyup(function () {//set balance when click amount key up
			var input_qty = $(this).val();
			var input_qty_int = parseInt(input_qty);


			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {
				var stock_card = $('#hid_stock_card').val();
				//alert(stock_card);
				// transaction.executeSql("SELECT stock_card.id,stock_card.descrip,sum(stock.dr_qty) as dr, sum(stock.cr_qty) as cr FROM stock INNER JOIN stock_card ON stock.stock_card=stock_card.stock_card  GROUP BY stock.stock_card LIMIT 10", [], function (tx, results) {
				var executeQuery = "SELECT stock_card.id,stock_card.descrip,sum(stock.dr_qty) as dr, sum(stock.cr_qty) as cr FROM stock INNER JOIN stock_card ON stock.stock_card=stock_card.stock_card WHERE stock.stock_card=? GROUP BY stock.stock_card";
				transaction.executeSql(executeQuery, [stock_card],
					function (tx, results) {
						var len = results.rows.length, i;
						//alert(len);

						for (i = 0; i < len; i++) {
							var dr = results.rows.item(i).dr;
							var cr = results.rows.item(i).cr;
							var blance = dr - cr;
							$('#hidden_balance').val(blance);


						}
					}, null);
			});

			var len = $("#mod_qty").val().length;
			var len_int = parseFloat(len);
			var stock_balance = $('#mod_ava').val();
			var balance_int = parseFloat(stock_balance);
			if (len_int !== 0) {
				if (((input_qty_int) > (balance_int)) || (input_qty_int === 0)) {
					$('#val_qty').fadeIn();
					$('#done').addClass("hidden");
				} else {
					$('#done').removeClass("hidden");
					$("#val_qty").fadeOut();
				}
			} else if (len_int == 0) {
				$("#val_qty").fadeOut();
				$('#done').removeClass("hidden");
			}



		});

		/************************************************qty validation**********************************************************************/
		$("#done").click(function () {


			var stock_book = $('#hid_stock_book').val();
			var stock_book_int = parseInt(stock_book);
			var cus_id1 = $('#hid_acc_no').val();
			var stock_card1 = $('#hid_stock_card').val();


			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {
				//var executeQuery = "SELECT stock_orders.invoice,stock_orders.flag,stock_orders.cus_id,stock.stock_card FROM stock_orders INNER JOIN stock ON stock_orders.ref=stock.ref WHERE stock_orders.cus_id=? AND stock.stock_card=? AND stock_orders.invoice=0 AND stock_orders.flag=1";
				var executeQuery = "SELECT * FROM stock WHERE stock.cus_id=? AND stock.stock_card=? AND stock.inv=0 AND stock.flag=1";
				transaction.executeSql(executeQuery, [cus_id1, stock_card1],
					function (tx, results) {
						var len = results.rows.length, i;
						if ((len == 0)) {
							validate_mod_qty();
							if (validate_qty) {


								var qty = $('#mod_qty').val();
								var discount1 = $('#mod_dis').val();
								var price = $('#mod_price').val();

								var price_int = parseFloat(price);
								var qty_int = parseFloat(qty);
								if (discount1 =='') {
									var discount_int = "0";
								} else {
									var discount_int = parseFloat(discount1);
								}



								var total_insert = ((((price_int) - ((price_int * discount_int) / 100)) * qty_int).toFixed(2));





								var dis_final_insert = ((((price_int * discount_int) / 100) * qty_int).toFixed(2));







								var auto_increment1 = $('#hid_auto').val();
								var auto_int1 = parseInt(auto_increment1);
								var auto_id1 = (auto_int1 + 1);

								$('#hid_auto').val(auto_id1);





								var unit_cost2 = "0";
								var dr_qty2 = "0";
								var cr_qty2 = $('#mod_qty').val();
								//var ref = $('#hid_ref_id').val();
								var ref2 = "0";
								var status2 = $('#mod_itmname').val();
								var s_price2 = $('#mod_price').val();



								var stock_card2 = $('#hid_stock_card').val();



								var stores2 = $.session.get("user_id");
								var pprice2 = total_insert;
								var unit_vat2 = "0";


								var l_dis2 = $('#mod_dis').val();





								var descrip2 = "Item";
								var line_dis2 = dis_final_insert;
								var unit_price2 = "0";
								var tym2 = "0";
								var foc2 = 0;
								var flg2 = $('#hid_auto').val();
								var r_price2 = "0";
								var w_price2 = "0";
								var br2 = "2";
								var flag2 = "1";
								var m_grd2 = "0";
								var inv2 = "0";
								var expire2 = "0";
								var exp_flag2 = "0";
								var cus_id2 = $('#hid_acc_no').val();
								myDB.transaction(function (transaction) {


									var executeQuery = "INSERT INTO stock (unit_cost, dr_qty, cr_qty,ref, status, s_price, stock_card,stores,p_price,unit_vat, l_dis, descrip, line_dis, unit_price, tym, foc, flg, r_price, w_price, br,flag,m_grd,inv,expire,exp_flag,cus_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
									transaction.executeSql(executeQuery, [unit_cost2, dr_qty2, cr_qty2, ref2, status2, s_price2, stock_card2, stores2, pprice2, unit_vat2, l_dis2, descrip2, line_dis2, unit_price2, tym2, foc2, flg2, r_price2, w_price2, br2, flag2, m_grd2, inv2, expire2, exp_flag2, cus_id2]
										, function (tx, result) {



										},
										function (error) {
											swal("Something Went Wrong", "error when inserting data", "warning");
										});

								});
								var auto2 = $('#hid_auto').val();
								//alert(ref_increment);
								var auto2_int = parseInt(auto2);
								var auto2_out = (auto2_int + 1);

								$('#hid_auto').val(auto2_out);
								myDB.transaction(function (transaction) {
									var executeQuery = "UPDATE increment_inv SET auto=?";
									transaction.executeSql(executeQuery, [auto2_out],
										function (tx, result) {
											//alert("update successfull");
											$('.tbl1').removeClass("hidden");
											$('#com').removeClass("hidden");
											//$('#add_tbl').addClass("hidden");
											$('#txt_2').val('');
											$('#model_item').modal('hide');
											//$("#search_res_itm").hide();
											$('#search_res_itm tbody').remove();
											load_first_itm_list();
											load_item_token_tbl();


										},
										function (error) {
											swal("Something Went Wrong", "error when getting data", "warning");
										});




								});


							}
						} else {
							$('.tbl1').removeClass("hidden");
							//$("#search_res_itm").hide();
							$('#search_res_itm tbody').remove();
							load_first_itm_list();
							load_item_token_tbl();


							swal("Item Already Exist", " ", "warning");
							$('#model_item').modal('hide');
							$('#txt_2').val('');
							$('#com').removeClass("hidden");
						}

					}, null);
			});




		});



		function load_item_token_tbl() {

			$('.tbl1').removeClass("hidden");
			$('#com').removeClass("hidden");
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });

			myDB.transaction(function (transaction) {
				var user_id = $('#hid_acc_no').val();
				//alert(user_id);
				var invoice = 0;


				var executeQuery = "SELECT * FROM stock  WHERE stock.cus_id=? AND stock.inv=? AND stock.flag=1";
				//var executeQuery = "SELECT stock_orders.ref,stock_orders.type,stock_orders.job,stock.cr_qty,stock_orders.discount,stock_orders.total FROM stock_orders INNER JOIN stock ON stock.ref=stock_orders.ref WHERE stock_orders.cus_id=? AND stock_orders.invoice=? AND stock_orders.flag=1 AND stock.flag=1";
				//var executeQuery = "SELECT stock_card.stock_card, stock_card.descrip, stock_orders.date, stock.ref, stock.dr_qty, stock.cr_qty FROM stock INNER JOIN stock_orders ON stock.ref = stock_orders.ref WHERE stock_orders.cus_id=? AND stock_orders.invoice=?";
				transaction.executeSql(executeQuery, [user_id, invoice],
					function (tx, results) {
						//transaction.executeSql('SELECT * FROM stock_orders', [], function (tx, results) {
						var len = results.rows.length, i;
						// alert(len);
						if (len === 0) {
							$("#TableData").html('').append('<tr><td colspan="8">No Data Found in database</td></tr>');
							$('#com').addClass("hidden");
							$('.tbl1').addClass("hidden");

						} else {
							$("#TableData").html('').append('<tr style="display:none"><td colspan="8">No Data Found in database</td></tr>');


							for (i = 0; i < len; i++) {



								$("#TableData").append("<tr class='link'><td>" + (i + 1) + "</font></td>\n\
			<td><font size='3'>" + results.rows.item(i).status + "</font></td>\n\
                        <td><font size='3'>" + results.rows.item(i).cr_qty + "</font></td>\n\
                        <td><font size='3'>" + results.rows.item(i).line_dis + "</font></td>\n\
                        <td><font size='3'>" + results.rows.item(i).p_price + "</font></td>\n\
			<td><button class='btn btn-danger btn-xs delete_load' value='" + results.rows.item(i).flg + "'><i class='ace-icon fa fa-trash-o bigger-130'></i></button>&nbsp;\n\
			</td>\n\
                        </tr>");

							}

							cal_sub_tot_final();

							cal_dis_tot_final();


							$('.delete_load').click(function () {   //when press Delete button in the table
								// $('#did').val($(this).val());
								var id_del = $(this).val();
								//alert(id_del);
								swal({
									title: "Are you sure?",
									text: "You will not be able to recover this data!",
									type: "warning",
									showCancelButton: true,
									confirmButtonColor: "#DD6B55",
									confirmButtonText: "Yes, delete it!",
									closeOnConfirm: false
								}, function () {
									var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
									myDB.transaction(function (transaction) {
										var executeQuery = "DELETE FROM stock WHERE flg=? AND flag=1";
										transaction.executeSql(executeQuery, [id_del],
											//On Success
											function (tx, result) {
												// myDB.transaction(function (transaction) {
												var user_id1 = $('#hid_acc_no').val();

												var invoice1 = 0;
												var executeQuery = "DELETE FROM stock WHERE stock.cus_id=? AND stock.inv=? AND stock.flag=1 AND stock.foc=1";
												transaction.executeSql(executeQuery, [user_id1, invoice1],
													//On Success
													function (tx, result) {

														swal({
															position: 'center',
															type: 'success',
															title: 'Successfully Deleted!',
															showConfirmButton: false,
															timer: 1000
														})
														load_item_token_tbl();


													},
													function (error) {
														swal("Something Went Wrong", "Your Data could not Deleted", "warning");
													});
												// });



											},
											function (error) {
												swal("Something Went Wrong", "Your Data could not Deleted", "warning");
											});
									});




								});
							});



						}
					}, null);

			});






		}




		function cal_sub_tot_final() {
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
			myDB.transaction(function (transaction) {
				var user_id = $('#hid_acc_no').val();

				var invoice = 0;


				var executeQuery = "SELECT sum(stock.p_price) AS tot_final FROM stock  WHERE stock.cus_id=? AND stock.inv=? AND stock.flag=1";

				transaction.executeSql(executeQuery, [user_id, invoice],
					function (tx, results) {
						var len = results.rows.length, i;

						for (i = 0; i < len; i++) {
							$("#sub_total_token").val(results.rows.item(i).tot_final);
						}
						//$('#loader_sub').html("").hide();
					}, null);
			});
		}

		function cal_dis_tot_final() {
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });
			myDB.transaction(function (transaction) {
				var user_id = $('#hid_acc_no').val();

				var invoice = 0;
				//alert("ok");

				var executeQuery = "SELECT sum(stock.line_dis) AS tot_dis FROM stock  WHERE stock.cus_id=? AND stock.inv=? AND stock.flag=1";

				transaction.executeSql(executeQuery, [user_id, invoice],
					function (tx, results) {
						var len = results.rows.length, i;

						for (i = 0; i < len; i++) {
							$("#sub_total_dis").val(results.rows.item(i).tot_dis);
						}
						//$('#loader_sub').html("").hide();
					}, null);
			});
		}



		///////////////////////////////////*********complete invoice***********////////////////////////    
		$("#com").click(function () {
			$('#payment_detail').modal({ backdrop: 'static', keyboard: false });

			var sub_pay = $("#sub_total_token").val();
			var sub_pay_int = parseFloat(sub_pay);
			//var sub_exchange = $("#sub_total_return").val();
			//var sub_exchange_int = parseFloat(sub_exchange);
			var final_balance = (sub_pay_int);

			$("#gross").val(final_balance);


			var value_int = 0;
			$("#pay_tot").val(value_int);
			$("#pay_amount").val('');
			$("#pay_cash").val('');
			$("#pay_bal").val(final_balance);
			var pay_date = $("#hid_date").val();

			$("#pay_date").val(pay_date);




		});


		$("#pay_cash").keyup(function () {
			//$("#pay_cash").val('');
			var len = $("#pay_cash").val().length;
			var len_int = parseInt(len);
			if (len_int !== 0) {
				var pay_cash = $("#pay_cash").val();
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = $("#pay_amount").val();
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);

				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			} else if (len_int == 0) {
				//var value_int = 0;
				//$("#pay_cash").val(value_int);
				var pay_cash = '0';
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = $("#pay_amount").val();
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);

				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			}
			if ($("#pay_amount").val() == '') {
				$("#pay_no").prop("readonly", true);

				var pay_cash = $("#pay_cash").val();
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = '0'
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);
				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			}
			if ((($('#pay_cash').val()) == '') && (($('#pay_amount').val()) == '')) {
				var sub_pay = $("#gross").val();
				var value_int = 0;
				$("#pay_bal").val(sub_pay);
				$("#pay_tot").val(value_int);
			}





		});


		$("#pay_amount").keyup(function () {

			$("#pay_no").prop("readonly", false);

			var len = $("#pay_amount").val().length;
			var len_int = parseInt(len);
			if (len_int !== 0) {
				var pay_cash = $("#pay_cash").val();
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = $("#pay_amount").val();
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);

				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			} else if (len_int == 0) {
				$("#pay_no").prop("readonly", true);
				// $("#pay_amount").val(value_int);
				var pay_cash = $("#pay_cash").val();
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = '0';
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);

				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			}
			if ($("#pay_cash").val() == '') {

				var pay_cash = '0';
				var pay_cash_int = parseInt(pay_cash);
				var gross = $("#gross").val();
				var gross_int = parseInt(gross);
				var pay_amount = $("#pay_amount").val();
				var pay_amount_int = parseInt(pay_amount);
				var tot_cash_chque = (pay_cash_int + pay_amount_int);
				var pay_balance = gross_int - (pay_cash_int + pay_amount_int);
				$("#pay_bal").val(pay_balance);
				$("#pay_tot").val(tot_cash_chque);

			}
			if ((($('#pay_cash').val()) == '') && (($('#pay_amount').val()) == '')) {
				var sub_pay = $("#gross").val();
				var value_int = 0;
				$("#pay_bal").val(sub_pay);
				$("#pay_tot").val(value_int);
			}




		});

		////////////////////////////////***********complete invoice*************/////////////////////////////////////////	    


		$("#pay").click(function () {
			//if ((($('#pay_cash').val()) == '') || (($('#pay_amount').val()) == '')) {

			// swal("Please Enter valid Amont", "", "warning");


			//} else {
			var ref_increment = $('#hid_ref_id').val();
			var ref_int = parseInt(ref_increment);
			var ref_id = (ref_int + 1);

			$('#hid_ref_id').val(ref_id);

			var cus_id = $('#hid_acc_no').val();
			var invoice_id = $('#hid_invoice_id').val();
			var myDB = window.sqlitePlugin.openDatabase({ name: "cmx.db", location: 'default' });


			var date_hid = $("#hid_date").val();
			var date = date_hid;
			var sup_acc = "0";

			var discount = $("#sub_total_dis").val();


			var type = "0";

			var invoice = invoice_id;
			var login = "0";




			var ref_id = $('#hid_ref_id').val();
			//alert(ref_id);
			var p_order = "0";

			var job = "0";

			var cashier = "0";

			var sales_return = "0";

			var gatepass = "0";

			var salemen = "0";

			// var stock_date = data.Stock_date;
			//alert(stock_date);

			var loading = "0";

			var unloading = "0";
			var csh = $('#sub_total_foc').val();
			var csh_out;
			if (csh == '') {
				csh_out = "0"
			} else {
				csh_out = $('#sub_total_foc').val();
			}
			var crdt = $('#sub_total_return').val();


			var sum_id = "0";


			var dis_amt = "0";

			var l_amt = "0";

			var pro = "0";

			var pack_no = "0";
			var br = "2";
			var agent_id = $.session.get("user_id");
			//alert(agent_id);
			// var agent_id = "2";
			var flag = "1";
			var cus_id1 = $('#hid_acc_no').val();
			var total = $('#sub_total_token').val();
			var qty = "0";
			var stock_card = "0";


			var cash = $('#pay_cash').val();
			var cheque = $('#pay_amount').val();
			var cheque_no = $('#pay_no').val();
			var cheque_date = $('#pay_date').val();
			var due = $('#pay_bal').val();
			var bank = $('#bank').val();






			myDB.transaction(function (transaction) {
				var executeQuery = "INSERT INTO stock_orders (date,sup_acc, discount, type, invoice,login,ref,p_order,job,cashier, sales_return, gatepass,salemen,loading,unloading, csh, crdt, sum_id,dis_amt, l_amt, pro, pack_no, br,agent_id,flag,cus_id ,total,qty,stock_card,cash ,cheque ,cheque_no ,cheque_date ,due,bank) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				transaction.executeSql(executeQuery, [date, sup_acc, discount, type, invoice, login, ref_id, p_order, job, cashier, sales_return, gatepass, salemen, loading, unloading, csh_out, crdt, sum_id, dis_amt, l_amt, pro, pack_no, br, agent_id, flag, cus_id1, total, qty, stock_card, cash, cheque, cheque_no, cheque_date, due, bank]
					, function (tx, result) {

						var ref_id = 0;
						var user_id = $('#hid_acc_no').val();
						//myDB.transaction(function (transaction) {
						//var executeQuery = "SELECT * FROM stock WHERE ref=? AND inv=0 AND flag=1";
						//transaction.executeSql(executeQuery, [ref_id],
						//function (tx, results) {
						//var len_com1 = results.rows.length, s;
						//for (s = 0; s < len_com1; s++) {
						//alert(s);
						//$("#com_id_stock").val(results.rows.item(s).id);
						//var com_id_stock = $('#com_id_stock').val();
						var ref_id1 = $('#hid_ref_id').val();
						myDB.transaction(function (transaction) {
							var executeQuery = "UPDATE stock SET inv=?,ref=? WHERE ref=? AND cus_id=? AND inv=0 AND flag=1";
							transaction.executeSql(executeQuery, [invoice_id, ref_id1, ref_id, user_id],
								//On Success
								function (tx, result) {
									//alert(len_com1);
									// if (s == len_com1) {

									//myDB.transaction(function (transaction) {
									transaction.executeSql('CREATE TABLE IF NOT EXISTS outstanding (id integer primary key, acc_no numeric, bal_dr numeric,bal_cr numeric,date numeric,type numaric,res_no numaric,flag integer)', [],
										function (tx, result) {

											var acc_no = $('#hid_acc_no').val();
											var bal_dr = $('#pay_bal').val();
											var bal_cr = "0";
											var date = date_hid;
											var type = "Invoice";
											var res_no = $.session.get("user_id");
											var flag = "1";
											//myDB.transaction(function (transaction) {
											var executeQuery = "INSERT INTO outstanding (acc_no, bal_dr ,bal_cr,date,type,res_no,flag) VALUES (?,?,?,?,?,?,?)";
											transaction.executeSql(executeQuery, [acc_no, bal_dr, bal_cr, date, type, res_no, flag]
												, function (tx, result) {

													var ref_increment = $('#hid_ref_id').val();
													var ref_int = parseInt(ref_increment);
													var ref_id = (ref_int + 1);
													var incre_id = $('#hid_invoice_id').val();
													//alert(incre_id);
													var invoice_int = parseInt(incre_id);
													var invo_id = (invoice_int + 1);


													//myDB.transaction(function (transaction) {
													var executeQuery = "UPDATE increment_inv SET inv_id=?,ref=?";
													transaction.executeSql(executeQuery, [invo_id, ref_id],
														function (tx, result) {


															swal({
																position: 'center',
																type: 'success',
																title: 'Successfully Completed!',
																showConfirmButton: false,
																timer: 1000
															})

															setTimeout(function () {
																window.location.href = "invoice.html";
															}, 1100);



														},
														function (error) {
															swal("Something Went Wrong", "error when getting data", "warning");
														});


												},
												function (error) {
													alert('Error occurred');
												});
											// });

											//});

										},
										function (error) {
											$("#loading").fadeOut();
											alert("Error occurred while creating the table.");
										});

									// });


									//}
								},
								//On Error
								function (error) {
									swal("Something Went Wrong", "Data Update error", "warning");
								});
						});
						//}
						//}, null);
						//});

					},
					function (error) {
						swal("Something Went Wrong", "error when inserting stock entry data", "warning");
					});

			});

			//}
		});
	</script>
</body>

</html>